# HAS Pattern Configuration v2.4 - Fixed
# Combines data-driven patterns with working v2.3d logic

targets:
  Population:
    patterns:
      # Explizite Header (häufigste aus Analyse)
      - '^Population\s+cible'
      - '^Population\s+pédiatrique'
      - '^Population\(s\)'
      - '^Population\s+d''analyse'
      - '^Populations\s+d''analyse'
      - '^Population\s+de\s+l''AMM'
      - '^Population\s+ITT'
      # Mit Nummerierung
      - '^09\.3\s+Population\s+cible'
      - '^04\.3\s+Population\s+cible'
      - '^Populations\s+particulières'
      # Alte bewährte Fallback-Patterns (für Texte ohne Header)
      - '^[•\-–—\u2022\u2794]?\s*(?:Enfants?|Adolescents?|Adultes?).{0,80}?âg[ée]s?\s+de\s+\d+(?:\s*(?:à|-|–)\s*\d+)?\s*ans\b'
      - '(?i)\bchez\s+les?\s+patients?\s+(?:adultes?|enfants?|adolescents?).{0,120}'
    
    stop_after:
      - '^Avis\s+version\s+définitive'
      - '^Avis\s+définitif'
      - '^Résultats'
      - '^Conditionnements?'
      - '^Service\s+Médical\s+Rendu'
      - '^SMR\b'
      - '^Autres\s+recommandations'
      - '^HAS\s*•'
      - '^Compte\s+tenu'
    
    forbid:
      - '\b(\d+([\.,]\d+)?)\s*(%|mg|µg|mcg|ml)\b'

  Subpopulation:
    patterns:
      - '^Sous-population'
      - '^Sous\s+populations?'
      - '^Population\s+sp[eéèê]cifique'
    
    stop_after:
      - '^Autres\s+recommandations'
      - '^Conditionnements?'
      - '^HAS\s*•'
    
    forbid: []

  "Indication (normalized)":
    patterns:
      # Häufigste aus Analyse
      - '^Indication\s+concernée\s+par\s+l''évaluation'
      - '^Indication\s+concernée'
      - '^Indications?\s+de\s+l''AMM'
      - '^Libell[ée]\s+de\s+l''indication'
      - '^Indication\s*:\s*'
      - '^Indications?\s*:\s*'
    
    stop_after:
      - '^Indication\s+de\s+l''AMM'
      - '^Extension\s+d''indication'
      - '^SMR'
      - '^ASMR'
      - '^DCI\b'
      - '^ATC\b'
      - '^Laboratoire'
      - '^Service\s+Médical\s+Rendu'
      - '^Taux\s+de\s+remboursement'
      - '^HAS\s*•'
    
    forbid: []

  "Comparator(s)":
    patterns:
      # Basis-Pattern
      - '^Comparateurs\s+cliniquement\s+pertinents'
      - '^Comparateurs\s+cliniquement\s+pertinents\s+dans\s+le\s+périmètre'
      # Nummerierte Varianten (aus Analyse)
      - '^05\s+COMPARATEURS\s+CLINIQUEMENT\s+PERTINENTS'
      - '^03\s+COMPARATEURS\s+CLINIQUEMENT\s+PERTINENTS'
      - '^06\s+COMPARATEURS\s+CLINIQUEMENT\s+PERTINENTS'
      - '^04\s+COMPARATEURS\s+CLINIQUEMENT\s+PERTINENTS'
      # Alternativen
      - '^Strat[ée]gies?\s+comparatives?'
      - '^Comparateurs?\s*:'
    
    stop_after:
      - '^Service\s+Médical\s+Rendu'
      - '^Amélioration\s+du\s+Service\s+Médical\s+Rendu'
      - '^Population\s+cible'
      - '^Avis\s+version\s+définitive'
      - '^Comparateurs\s+non\s+médicamenteux'
      - '^Conclusions?\s+de\s+la\s+Commission'
      - '^HAS\s*•'
    
    forbid:
      - '\b(\d+([\.,]\d+)?)\s*(%|mg|µg|mcg|ml|ans|mois)\b'

  "Conclusion (CT)":
    patterns:
      # Inhaltliche Patterns (bewährt aus v2.3d)
      - 'avis\s+(favorable|d[ée]favorable)'
      - '\b(maintien|renouvellement)\s+d''inscription\b'
      - '\b(non-)?inscription\b'
      - 'taux\s+de\s+remboursement\s*:\s*\d+\s*%'
      # Strukturelle Patterns (aus Analyse)
      - '^Service\s+Médical\s+Rendu'
      - '^Amélioration\s+du\s+Service\s+Médical\s+Rendu'
      - '^SMR\s+(?:important|modéré|faible|insuffisant)'
      - '^SMR$'
      - '^ASMR$'
    
    stop_after:
      - '^Population\s+cible'
      - '^ASMR\s+V'
      - '^Compte\s+tenu'
      - '^Avis\s+version\s+définitive'
      - '^Date\s+de\s+l''avis'
      - '^HAS\s*•'
    
    forbid: []
